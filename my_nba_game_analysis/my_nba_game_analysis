import os
os.chdir("/home/jovyan/")
print(os.getcwd())

import csv
import pandas as pd
import numpy as np

def csv_read(file_name):
    col_names = "PERIOD|REMAINING_SEC|RELEVANT_TEAM|AWAY_TEAM|HOME_TEAM|AWAY_SCORE|HOME_SCORE|DESCRIPTION"
    col_names = col_names.split("|")
    with open(file_name) as File:  
        csv_data = csv.reader(File, delimiter='|')
        df = pd.DataFrame(None, columns=col_names)
        for row in csv_data:
            df = df.append(pd.DataFrame(np.reshape(row, (1,8)), columns=col_names), ignore_index=True)
        return df

def analyse_nba_game(data):       
    dict={"home_team":{}, "away_team":{}}
    dict["home_team"]["name"] = ",".join(np.unique(data["HOME_TEAM"]))
    dict["away_team"]["name"] = ",".join(np.unique(data["AWAY_TEAM"]))
    
    
    dict["home_team"]["players_data"] = analyse_data(data, dict["home_team"]["name"])
    dict["away_team"]["players_data"] = analyse_data(data, dict["away_team"]["name"])
    
   
    print(dict)
    
def analyse_data(data, team_name):
    df = data.where(data["RELEVANT_TEAM"] == team_name)

    return df


# FG – количество бросков, попавших в корзину, за исключением штрафных бросков (Field Goals);</li>
# FGA – количество всех выполненных бросков (Field Goals Attempts);</li>
# FG% – процентное соотношение между результативными бросками и общим количеством выполненных бросков (Field Goals Percentage);</li>
# 3P – количество результативных бросков из трёхочковой зоны (3-Point Field Goals);</li>
# 3PA – количество всех выполненных бросков из трёхочковой зоны (3-Point Field Goals Attempts);</li>
# 3P% – процентное соотношение между результативными трёхочковыми бросками и общим количеством выполненных трёхочковых бросков (3-Point Field Goals Percentage);</li>
# FT – количество результативных штрафных бросков (Free Throws);</li>
# FTA – общее количество штрафных бросков (Free Throws Attempts);</li>
# FT% – процентное соотношение между результативными штрафными бросками и общим количеством штрафных бросков (Free Throws Percentage);</li>
# ORB – количество выигранных подборов под корзиной соперника (Offensive Rebounds);</li>
# DRB – количество выигранных подборов под своей корзиной (Defensive Rebounds);</li>
# TRB – полное количество выигранных подборов (Total Rebounds);</li>
# AST – количество передач, после которых был выполнен результативный бросок (Assists);</li>
# STL – количество удачных перехватов мяча (Steals);</li>
# BLK – количество удачно выполненных блоков (Blocks);</li>
# TOV – количество потерянных мячей (Turnovers);</li>
# PF – количество персональных замечаний (Personal Fouls);</li>
# PTS – количество набранных очков (Points);</li>





    

def my_nba_game_analysis(file_name):
    data = csv_read(file_name)
    analyse_nba_game(data)
    return data
    
    
my_nba_game_analysis('nba_game_blazers_lakers_20181018.csv')

            
            
# Аттрибуты csv.reader
# delimiter 	Устанавливает символ, с помощью которого разделяются элементы в файле. По умолчанию используется запятая.
# doublequote 	Если True, то символ quotechar удваивается, если False, то к символу qutechar добавляется ecsapechar в качестве префикса.
# escapechar 	Строка из одного символа, которая используется для экранирования символа-разделителя.
# lineterminator 	Определяет разделитель для строк, по умолчанию используется «\r\n»
# quotechar 	Определяет символ, который используется для окружения символа-разделителя. По умолчанию используются двойные кавычки, то есть quotechar = ‘ » ‘.
# quoting 	Определяет символ, который используется для экранирования символа разделителя (если не используются кавычки).
# skipinitialspace 	Если установить значение этого параметра в True, то все пробелы после символа-разделителя будут игнорироваться.
# strict 	Если установить в True, то при неправильном вводе CSV будет возбуждаться исключение Error.
